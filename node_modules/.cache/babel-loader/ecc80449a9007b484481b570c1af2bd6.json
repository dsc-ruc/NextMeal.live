{"ast":null,"code":"var _jsxFileName = \"/Users/jlap/Coding/StudentDeveloperChallenge/NextMeal.live/src/components/GoogleMap.js\";\nimport { Map, InfoWindow, Marker, GoogleApiWrapper } from 'google-maps-react';\nimport React, { Component } from \"react\";\nimport axios from \"axios\";\nimport ResturantMarker from '../images/resturantMarker.png';\nimport { Card } from 'react-bootstrap';\nconst style = {\n  width: \"100%\",\n  height: \"90vh\",\n  position: \"relative\"\n}; // Actual Magic: https://stackoverflow.com/a/41337005\n// Distance calculates the distance between two lat/lon pairs\n\nfunction distance(lat1, lon1, lat2, lon2) {\n  var p = 0.017453292519943295;\n  var a = 0.5 - Math.cos((lat2 - lat1) * p) / 2 + Math.cos(lat1 * p) * Math.cos(lat2 * p) * (1 - Math.cos((lon2 - lon1) * p)) / 2;\n  return 12742 * Math.asin(Math.sqrt(a));\n} // Takes an array of objects with lat and lon properties as well as a single object with lat and lon\n// properties and finds the closest point (by shortest distance).\n\n\nfunction closest(data, v) {\n  // console.log(data.map(p => distance(v['lat'],v['lon'],p['lat'],p['lon'])))\n  // console.log(Math.min(...data.map(p => distance(v['lat'],v['lon'],p['lat'],p['lon']))))\n  var distances = data.map(function (p) {\n    console.log(p);\n    return {\n      lat: p.location.coordinates[0],\n      lon: p.location.coordinates[1],\n      organization: p.name_of_restaurant,\n      address: p.address,\n      distance: distance(v.currlat, v.currlon, p.location.coordinates[0], p.location.coordinates[1])\n    };\n  });\n  var minDistance = Math.min(...distances.map(d => d.distance));\n  var closestTap = {\n    organization: \"\",\n    address: \"\",\n    lat: \"\",\n    lon: \"\"\n  };\n\n  for (var i = 0; i < distances.length; i++) {\n    if (distances[i].distance === minDistance) {\n      closestTap.lat = distances[i].lat;\n      closestTap.lon = distances[i].lon;\n      closestTap.organization = distances[i].organization;\n      closestTap.address = distances[i].address;\n    }\n  }\n\n  return closestTap;\n}\n\nfunction getCoordinates() {\n  return new Promise(function (resolve, reject) {\n    navigator.geolocation.getCurrentPosition(resolve, reject);\n  });\n}\n\nexport class GoogleMap extends Component {\n  constructor(_props) {\n    super(_props);\n\n    this.onMarkerClick = (props, marker, e) => this.setState({\n      selectedPlace: props,\n      activeMarker: marker,\n      showingInfoWindow: true\n    });\n\n    this.onClose = props => {\n      if (this.state.showingInfoWindow) {\n        this.setState({\n          showingInfoWindow: false,\n          activeMarker: null\n        });\n      }\n    };\n\n    this.onMapClicked = props => {\n      if (this.state.showingInfoWindow) {\n        this.setState({\n          showingInfoWindow: false,\n          activeMarker: null\n        });\n      }\n    };\n\n    this.state = {\n      showingInfoWindow: false,\n      activeMarker: {},\n      selectedPlace: {},\n      tapsLoaded: false,\n      allLocations: null,\n      closestPoint: null\n    };\n  }\n\n  renderMarkers() {\n    return this.state.allLocations.map(item => {\n      return React.createElement(Marker, {\n        icon: {\n          url: ResturantMarker,\n          anchor: new this.props.google.maps.Point(32, 32),\n          scaledSize: new this.props.google.maps.Size(64, 64)\n        },\n        onClick: this.onMarkerClick,\n        name: item.name_of_restaurant,\n        address: item.address,\n        sTime: item.food_available_start_time,\n        eTime: item.food_available_end_time,\n        foodAvail: item.food_available,\n        allergies: item.potential_allergies,\n        position: {\n          lat: item.location_y,\n          lng: item.location_x\n        },\n        qPos: item.location_y + \",\" + item.location_x,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 112\n        },\n        __self: this\n      });\n    });\n  }\n\n  render() {\n    console.log(this.state.closestPoint);\n    return React.createElement(React.Fragment, null, React.createElement(Map, {\n      google: this.props.google,\n      className: \"map\",\n      id: \"map\",\n      style: style,\n      zoom: 14,\n      initialCenter: {\n        lat: this.state.currlat,\n        lng: this.state.currlon\n      },\n      center: {\n        lat: this.state.currlat,\n        lng: this.state.currlon\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138\n      },\n      __self: this\n    }, React.createElement(Marker, {\n      onClick: this.onMarkerClick,\n      name: 'Current location',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149\n      },\n      __self: this\n    }, React.createElement(InfoWindow, {\n      marker: this.state.activeMarker,\n      onClose: this.onInfoWindowClose,\n      visible: this.state.showingInfoWindow,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156\n      },\n      __self: this\n    }, React.createElement(\"h1\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157\n      },\n      __self: this\n    }, this.state.selectedPlace.name)))), this.state.allLocations && this.renderMarkers(), React.createElement(Marker, {\n      icon: {\n        url: ResturantMarker,\n        anchor: new this.props.google.maps.Point(32, 32),\n        scaledSize: new this.props.google.maps.Size(64, 64)\n      },\n      onClick: this.onMarkerClick,\n      name: 'Holder Marker',\n      address: \"Location\",\n      sTime: \"Start Time\",\n      eTime: \"End Time\",\n      foodAvail: \"Food Avalible\",\n      allergies: \"Allergies\",\n      position: {\n        lat: 39.709262,\n        lng: -75.1240\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163\n      },\n      __self: this\n    }), React.createElement(InfoWindow, {\n      marker: this.state.activeMarker,\n      onClose: this.onInfoWindowClose,\n      visible: this.state.showingInfoWindow,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183\n      },\n      __self: this\n    }, React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184\n      },\n      __self: this\n    }, this.state.selectedPlace.name), React.createElement(\"a\", {\n      href: \"https://www.google.com/maps/search/?api=1&query=\" + this.state.selectedPlace.qPos,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185\n      },\n      __self: this\n    }, React.createElement(\"h5\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186\n      },\n      __self: this\n    }, \"Address: \" + this.state.selectedPlace.address)), React.createElement(\"h5\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189\n      },\n      __self: this\n    }, \"Open Time: \" + this.state.selectedPlace.sTime), React.createElement(\"h5\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190\n      },\n      __self: this\n    }, \"Close Time: \" + this.state.selectedPlace.eTime), React.createElement(\"h5\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191\n      },\n      __self: this\n    }, \"Food Available: \" + this.state.selectedPlace.foodAvail), React.createElement(\"h5\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192\n      },\n      __self: this\n    }, \"Allergies: \" + this.state.selectedPlace.allergies)))), React.createElement(Card, {\n      style: {\n        width: '15rem'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197\n      },\n      __self: this\n    }, React.createElement(Card.Body, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198\n      },\n      __self: this\n    }, React.createElement(Card.Title, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199\n      },\n      __self: this\n    }, \"Closest Location\"), React.createElement(Card.Text, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201\n      },\n      __self: this\n    }, React.createElement(\"a\", {\n      href: \"https://www.google.com/maps/search/?api=1&query=\" + (this.state.closestPoint && this.state.closestPoint.lat) + \", \" + (this.state.closestPoint && this.state.closestPoint.lon),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202\n      },\n      __self: this\n    }, this.state.closestPoint && this.state.closestPoint.organization)))));\n  }\n\n}\nexport default GoogleApiWrapper({\n  apiKey: \"AIzaSyBIQpZBgN7WPGuBCRsCXQBfZJvetJxurFg\"\n})(GoogleMap);","map":{"version":3,"sources":["/Users/jlap/Coding/StudentDeveloperChallenge/NextMeal.live/src/components/GoogleMap.js"],"names":["Map","InfoWindow","Marker","GoogleApiWrapper","React","Component","axios","ResturantMarker","Card","style","width","height","position","distance","lat1","lon1","lat2","lon2","p","a","Math","cos","asin","sqrt","closest","data","v","distances","map","console","log","lat","location","coordinates","lon","organization","name_of_restaurant","address","currlat","currlon","minDistance","min","d","closestTap","i","length","getCoordinates","Promise","resolve","reject","navigator","geolocation","getCurrentPosition","GoogleMap","constructor","props","onMarkerClick","marker","e","setState","selectedPlace","activeMarker","showingInfoWindow","onClose","state","onMapClicked","tapsLoaded","allLocations","closestPoint","renderMarkers","item","url","anchor","google","maps","Point","scaledSize","Size","food_available_start_time","food_available_end_time","food_available","potential_allergies","location_y","lng","location_x","render","onInfoWindowClose","name","qPos","sTime","eTime","foodAvail","allergies","apiKey"],"mappings":"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","sourcesContent":["import {Map, InfoWindow, Marker, GoogleApiWrapper} from 'google-maps-react';\nimport React, { Component } from \"react\";\nimport axios from \"axios\";\nimport ResturantMarker from '../images/resturantMarker.png';\nimport {Card} from 'react-bootstrap';\n\nconst style = {\n    width: \"100%\",\n    height: \"90vh\",\n    position: \"relative\",\n  };\n\n  // Actual Magic: https://stackoverflow.com/a/41337005\n// Distance calculates the distance between two lat/lon pairs\nfunction distance(lat1, lon1, lat2, lon2) {\n  var p = 0.017453292519943295;\n  var a =\n    0.5 -\n    Math.cos((lat2 - lat1) * p) / 2 +\n    (Math.cos(lat1 * p) *\n      Math.cos(lat2 * p) *\n      (1 - Math.cos((lon2 - lon1) * p))) /\n      2;\n  return 12742 * Math.asin(Math.sqrt(a));\n}\n\n// Takes an array of objects with lat and lon properties as well as a single object with lat and lon\n// properties and finds the closest point (by shortest distance).\nfunction closest(data, v) {\n  // console.log(data.map(p => distance(v['lat'],v['lon'],p['lat'],p['lon'])))\n  // console.log(Math.min(...data.map(p => distance(v['lat'],v['lon'],p['lat'],p['lon']))))\n  var distances = data.map(function(p) {\n    console.log(p);\n    return {\n      lat: p.location.coordinates[0],\n      lon: p.location.coordinates[1],\n      organization: p.name_of_restaurant,\n      address: p.address,\n\n      distance: distance(v.currlat, v.currlon, p.location.coordinates[0], p.location.coordinates[1])\n    };\n  });\n  var minDistance = Math.min(...distances.map(d => d.distance));\n\n  var closestTap = {\n    organization: \"\",\n    address: \"\",\n    lat: \"\",\n    lon: \"\"\n  };\n\n  for (var i = 0; i < distances.length; i++) {\n    if (distances[i].distance === minDistance) {\n      closestTap.lat = distances[i].lat;\n      closestTap.lon = distances[i].lon;\n      closestTap.organization = distances[i].organization;\n      closestTap.address = distances[i].address;\n    }\n  }\n\n  return closestTap;\n}\n\n  function getCoordinates() {\n    return new Promise(function(resolve, reject) {\n      navigator.geolocation.getCurrentPosition(resolve, reject);\n    });\n  }\n\nexport class GoogleMap extends Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n          showingInfoWindow: false,\n          activeMarker: {},\n          selectedPlace: {},\n          tapsLoaded: false,\n          allLocations: null,\n          closestPoint: null,\n        };\n      }\n\n      onMarkerClick = (props, marker, e) =>\n    this.setState({\n      selectedPlace: props,\n      activeMarker: marker,\n      showingInfoWindow: true\n    });\n\n  onClose = props => {\n    if (this.state.showingInfoWindow) {\n      this.setState({\n        showingInfoWindow: false,\n        activeMarker: null\n      });\n    }\n  };\n\n  onMapClicked = props => {\n    if (this.state.showingInfoWindow) {\n      this.setState({\n        showingInfoWindow: false,\n        activeMarker: null\n      });\n    }\n  };\n\n  renderMarkers() {\n    return this.state.allLocations.map(item => {\n      return (\n        <Marker\n              icon={{\n                url: ResturantMarker,\n                anchor: new this.props.google.maps.Point(32,32),\n                scaledSize: new this.props.google.maps.Size(64,64)\n              }}\n              onClick={this.onMarkerClick}\n              name={item.name_of_restaurant}\n              address = {item.address}\n              sTime = {item.food_available_start_time}\n              eTime = {item.food_available_end_time}\n              foodAvail = {item.food_available}\n              allergies = {item.potential_allergies}\n              position={{lat: item.location_y, lng: item.location_x}}\n              qPos = {item.location_y + \",\" + item.location_x}\n              />\n      )\n    })\n  }\n\n  \n\n    render() {\n        console.log(this.state.closestPoint);\n        return (\n          <>\n        <Map google={this.props.google}\n            className={\"map\"}\n            id=\"map\"\n            style={style}\n            zoom={14}\n            initialCenter={{\n            lat: this.state.currlat,\n            lng: this.state.currlon\n            }}\n            center={{ lat: this.state.currlat, lng: this.state.currlon }}\n        >\n            <Marker\n            onClick={this.onMarkerClick}\n            name={'Current location'} >\n              <InfoWindow\n                marker={this.state.activeMarker}\n                onClose={this.onInfoWindowClose}\n                visible={this.state.showingInfoWindow}>\n                <div>\n                <h1>{this.state.selectedPlace.name}</h1>\n                </div>\n            </InfoWindow>\n            </Marker>\n\n            {this.state.allLocations && this.renderMarkers()}\n            <Marker\n                  icon={{\n                    url: ResturantMarker,\n                    anchor: new this.props.google.maps.Point(32,32),\n                    scaledSize: new this.props.google.maps.Size(64,64)\n                  }}\n                  onClick={this.onMarkerClick}\n                  name={'Holder Marker'}\n                  address = {\"Location\"}\n                  sTime = {\"Start Time\"}\n                  eTime = {\"End Time\"}\n                  foodAvail = {\"Food Avalible\"}\n                  allergies = {\"Allergies\"}\n                  position={{lat: 39.709262, lng: -75.1240}}/>\n\n\n            <InfoWindow\n                marker={this.state.activeMarker}\n                onClose={this.onInfoWindowClose}\n                visible={this.state.showingInfoWindow}>\n                <div>\n                <h3>{this.state.selectedPlace.name}</h3>\n                <a href={\"https://www.google.com/maps/search/?api=1&query=\" + this.state.selectedPlace.qPos}>\n                  <h5 >{\"Address: \" + this.state.selectedPlace.address}</h5>\n                </a>\n\n                <h5>{\"Open Time: \" + this.state.selectedPlace.sTime}</h5>\n                <h5>{\"Close Time: \" + this.state.selectedPlace.eTime}</h5>\n                <h5>{\"Food Available: \" + this.state.selectedPlace.foodAvail}</h5>\n                <h5>{\"Allergies: \" + this.state.selectedPlace.allergies}</h5>\n                </div>\n            </InfoWindow>\n        </Map>\n\n        <Card style={{ width: '15rem' }}>\n        <Card.Body>\n          <Card.Title>Closest Location</Card.Title>\n\n          <Card.Text>\n            <a href={\"https://www.google.com/maps/search/?api=1&query=\" + (this.state.closestPoint && this.state.closestPoint.lat) + \", \" + (this.state.closestPoint && this.state.closestPoint.lon) }>\n                  {this.state.closestPoint && this.state.closestPoint.organization}\n            </a>\n          </Card.Text>\n\n        </Card.Body>\n      </Card>\n      </>\n        );\n    }\n    }\n\nexport default GoogleApiWrapper({\n  apiKey: (\"AIzaSyBIQpZBgN7WPGuBCRsCXQBfZJvetJxurFg\")\n})(GoogleMap)\n"]},"metadata":{},"sourceType":"module"}